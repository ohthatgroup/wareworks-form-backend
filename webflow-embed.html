<div id="wareworks-application-container" style="
  width: 100%; 
  max-width: 100%; 
  margin: 0 auto;
  font-family: 'Figtree', sans-serif;
">
  <!-- Language and Disclaimer Section -->
  <div id="language-disclaimer" style="
    background: white; 
    border: 1px solid #e5e7eb; 
    border-radius: 0.75rem; 
    padding: 2rem; 
    margin: 0 auto 1.25rem; 
    max-width: 600px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  ">
    <!-- Title -->
    <h2 id="disclaimer-title" style="
      font-size: 1.5rem; 
      font-weight: 700; 
      color: #131f5b; 
      margin: 0 0 1.5rem 0; 
      text-align: center;
      font-family: 'Bricolage Grotesque', sans-serif;
    ">
      <span id="title-en">Welcome to WareWorks</span>
      <span id="title-es" style="display: none;">Bienvenido a WareWorks</span>
    </h2>
    
    <!-- Employment Eligibility Requirements -->
    <div style="margin-bottom: 1.5rem;">
      <h3 style="
        font-size: 1.125rem; 
        font-weight: 600; 
        color: #131f5b; 
        margin: 0 0 0.75rem 0;
      ">
        <span id="requirements-title-en">Employment Eligibility Requirements</span>
        <span id="requirements-title-es" style="display: none;">Requisitos de Elegibilidad para el Empleo</span>
      </h3>
      <p style="
        color: #374151; 
        line-height: 1.6; 
        margin: 0 0 1rem 0;
      ">
        <span id="requirements-text-en">All employees must be eligible to work in the United States. You will be required to provide documentation to verify your eligibility as part of the I-9 process. Federal law requires all employers to verify the identity and employment eligibility of all employees. You will need to provide acceptable documentation within three (3) business days of starting employment.</span>
        <span id="requirements-text-es" style="display: none;">Todos los empleados deben ser elegibles para trabajar en los Estados Unidos. Se le requerirá proporcionar documentación para verificar su elegibilidad como parte del proceso I-9. La ley federal requiere que todos los empleadores verifiquen la identidad y elegibilidad de empleo de todos los empleados. Necesitará proporcionar documentación aceptable dentro de tres (3) días hábiles de comenzar el empleo.</span>
      </p>
      
      <p style="
        color: #374151; 
        line-height: 1.6; 
        margin: 0;
      ">
        <span id="doc-requirements-en"><strong>Document Requirements:</strong> Accepted formats include PDF, JPG, JPEG, PNG. Maximum file size is 10MB per file. Documents must be clear and legible with personal information visible.</span>
        <span id="doc-requirements-es" style="display: none;"><strong>Requisitos de Documentos:</strong> Los formatos aceptados incluyen PDF, JPG, JPEG, PNG. El tamaño máximo de archivo es de 10MB por archivo. Los documentos deben ser claros y legibles con información personal visible.</span>
      </p>
    </div>
    
    <!-- Privacy Notice -->
    <div style="
      background: #f9fafb; 
      border: 1px solid #e5e7eb; 
      border-radius: 0.5rem; 
      padding: 1rem; 
      margin-bottom: 1.5rem;
    ">
      <p style="
        color: #374151; 
        line-height: 1.6; 
        margin: 0;
        font-size: 0.875rem;
      ">
        <span id="privacy-notice-en"><strong>Privacy Notice:</strong> By continuing, you acknowledge that the information you provide will be used for employment purposes and will be kept confidential according to applicable laws. All information provided will be verified during the background check process.</span>
        <span id="privacy-notice-es" style="display: none;"><strong>Aviso de Privacidad:</strong> Al continuar, usted reconoce que la información que proporciona será utilizada para propósitos de empleo y se mantendrá confidencial de acuerdo con las leyes aplicables. Toda la información proporcionada será verificada durante el proceso de verificación de antecedentes.</span>
      </p>
    </div>
    
    <!-- Language Selection -->
    <div style="margin-bottom: 1.5rem;">
      <p style="
        color: #374151; 
        font-weight: 500; 
        margin: 0 0 0.75rem 0; 
        text-align: center;
      ">
        <span id="language-prompt-en">Please select your preferred language:</span>
        <span id="language-prompt-es" style="display: none;">Por favor seleccione su idioma preferido:</span>
      </p>
      <div style="display: flex; gap: 0.75rem; justify-content: center;">
        <button
          id="english-button"
          onclick="selectLanguage('en')"
          style="
            background: #131f5b; 
            color: white; 
            border: none;
            padding: 0.75rem 1.5rem; 
            border-radius: 0.375rem; 
            font-weight: 500; 
            cursor: pointer; 
            transition: all 0.2s ease;
            font-family: 'Figtree', sans-serif;
          "
        >
          English
        </button>
        <button
          id="spanish-button"
          onclick="selectLanguage('es')"
          style="
            background: #6b7280; 
            color: white; 
            border: none;
            padding: 0.75rem 1.5rem; 
            border-radius: 0.375rem; 
            font-weight: 500; 
            cursor: pointer; 
            transition: all 0.2s ease;
            font-family: 'Figtree', sans-serif;
          "
        >
          Español
        </button>
      </div>
    </div>

    <!-- Continue Button -->
    <button
      id="continue-button"
      onclick="continueToApplication()"
      style="
        width: 100%; 
        max-width: 320px;
        background: #131f5b; 
        color: white; 
        border: none;
        padding: 1rem 2rem; 
        border-radius: 0.5rem; 
        font-weight: 500; 
        font-size: 1rem;
        cursor: pointer; 
        transition: all 0.2s ease;
        font-family: 'Figtree', sans-serif;
        box-shadow: 0 4px 12px rgba(19, 31, 91, 0.15);
        display: block;
        margin: 0 auto;
      " 
      onmouseover="this.style.background='#1e308e'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(19, 31, 91, 0.25)'" 
      onmouseout="this.style.background='#131f5b'; this.style.transform='none'; this.style.boxShadow='0 4px 12px rgba(19, 31, 91, 0.15)'"
    >
      Accept & Continue in English
    </button>
  </div>
  
  <!-- Loading Section (hidden initially) -->
  <div id="loading-section" style="
    display: none; 
    text-align: center; 
    padding: 3rem 2rem;
  ">
    <div style="
      width: 48px; 
      height: 48px; 
      border: 4px solid #e5e7eb; 
      border-top: 4px solid #131f5b; 
      border-radius: 50%; 
      margin: 0 auto 1.5rem; 
      animation: spin 1s linear infinite;
    "></div>
    <h3 id="loading-title" style="
      font-size: 1.25rem; 
      font-weight: 600; 
      color: #131f5b; 
      margin: 0 0 0.5rem 0;
      font-family: 'Bricolage Grotesque', sans-serif;
    ">
      <span id="loading-title-en">Loading Application</span>
      <span id="loading-title-es" style="display: none;">Cargando Aplicación</span>
    </h3>
    <p id="loading-text" style="
      color: #6b7280; 
      line-height: 1.5;
      margin: 0;
    ">
      <span id="loading-text-en">Please wait while we prepare your application form...</span>
      <span id="loading-text-es" style="display: none;">Por favor espere mientras preparamos su formulario de aplicación...</span>
    </p>
  </div>

  <!-- Progress Bar Container (shown after language selection) -->
  <div id="progress-bar-container" style="display: none; width: 100%;">
    <!-- Progress bar will be injected here -->
  </div>

  <!-- Application Container -->
  <div id="application-container" style="display: none; width: 100%;">
    <!-- The standalone application will be loaded here -->
  </div>
</div>

<style>
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  @import url('https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Figtree:ital,wght@0,300..900;1,300..900&display=swap');
  
  /* Responsive styles following style guide breakpoints */
  @media (max-width: 768px) {
    #language-disclaimer {
      margin: 0 1rem 1.25rem !important;
      padding: 1.5rem !important;
    }
    
    #disclaimer-title {
      font-size: 1.375rem !important;
    }
  }
  
  @media (max-width: 480px) {
    #disclaimer-title {
      font-size: 1.21rem !important;
    }
  }
</style>

<script>
(function() {
  'use strict';
  
  let selectedLanguage = 'en';
  
  // Configuration
  const CONFIG = {
    // Use localhost for development, replace with your actual Netlify URL when deployed
    FORM_APP_URL: window.location.hostname === 'localhost' || window.location.hostname.includes('webflow.io') 
      ? 'http://localhost:3000' 
      : 'https://wareworks-backend.netlify.app', // Your actual Netlify URL
    ANALYTICS_ID: 'G-XXXXXXXXXX', // Replace with your GA4 ID
    WEBFLOW_DOMAIN: window.location.hostname
  };

  // Analytics tracking
  function trackEvent(eventName, parameters = {}) {
    if (typeof gtag !== 'undefined') {
      gtag('event', eventName, {
        ...parameters,
        source: 'webflow_embed',
        webflow_domain: CONFIG.WEBFLOW_DOMAIN
      });
    }
  }

  // Language selection
  window.selectLanguage = function(language) {
    selectedLanguage = language;
    
    // Update button styles
    const englishBtn = document.getElementById('english-button');
    const spanishBtn = document.getElementById('spanish-button');
    const continueBtn = document.getElementById('continue-button');
    
    // Show/hide content based on selected language
    const enElements = document.querySelectorAll('[id$="-en"]');
    const esElements = document.querySelectorAll('[id$="-es"]');
    
    if (language === 'en') {
      englishBtn.style.background = '#131f5b';
      spanishBtn.style.background = '#6b7280';
      continueBtn.textContent = 'Accept & Continue in English';
      
      enElements.forEach(el => el.style.display = '');
      esElements.forEach(el => el.style.display = 'none');
    } else {
      englishBtn.style.background = '#6b7280';
      spanishBtn.style.background = '#131f5b';
      continueBtn.textContent = 'Aceptar y Continuar en Español';
      
      enElements.forEach(el => el.style.display = 'none');
      esElements.forEach(el => el.style.display = '');
    }
    
    trackEvent('language_selected', { language });
  }

  // Continue to application
  window.continueToApplication = function() {
    // Hide disclaimer and show loading
    document.getElementById('language-disclaimer').style.display = 'none';
    document.getElementById('loading-section').style.display = 'block';
    
    trackEvent('application_start', {
      language: selectedLanguage
    });
    
    setTimeout(() => loadApplication(), 500);
  }

  // Load the React application
  function loadApplication() {
    try {
      const iframe = document.createElement('iframe');
      iframe.src = `${CONFIG.FORM_APP_URL}?lang=${selectedLanguage}`;
      iframe.style.cssText = `
        width: 100%; 
        border: none; 
        min-height: 600px;
        background: transparent;
      `;
      iframe.onload = function() {
        document.getElementById('loading-section').style.display = 'none';
        document.getElementById('application-container').style.display = 'block';
        
        trackEvent('application_loaded');
      };
      iframe.onerror = function() {
        console.error('Failed to load application');
        const loadingTextEn = document.getElementById('loading-text-en');
        const loadingTextEs = document.getElementById('loading-text-es');
        if (selectedLanguage === 'en') {
          loadingTextEn.textContent = 'Failed to load application. Please refresh and try again.';
        } else {
          loadingTextEs.textContent = 'Error al cargar la aplicación. Por favor actualice y vuelva a intentar.';
        }
      };
      
      document.getElementById('application-container').appendChild(iframe);
    } catch (error) {
      console.error('Error loading application:', error);
      const loadingTextEn = document.getElementById('loading-text-en');
      const loadingTextEs = document.getElementById('loading-text-es');
      if (selectedLanguage === 'en') {
        loadingTextEn.textContent = 'An error occurred. Please refresh and try again.';
      } else {
        loadingTextEs.textContent = 'Ocurrió un error. Por favor actualice y vuelva a intentar.';
      }
    }
  }

  // Set up progress bar communication
  window.addEventListener('message', function(event) {
    if (event.data.type === 'progressUpdate') {
      updateProgressBar(event.data.current, event.data.total);
    } else if (event.data.type === 'applicationComplete') {
      trackEvent('application_complete', {
        submission_id: event.data.submissionId
      });
    }
  }, false);

  function updateProgressBar(current, total) {
    const container = document.getElementById('progress-bar-container');
    if (!container) return;
    
    const percentage = Math.round((current / total) * 100);
    container.innerHTML = `
      <div style="background: #f3f4f6; border-radius: 0.5rem; height: 8px; margin: 1rem 0;">
        <div style="
          background: linear-gradient(90deg, #131f5b 0%, #1e308e 100%); 
          height: 100%; 
          border-radius: 0.5rem; 
          width: ${percentage}%;
          transition: width 0.3s ease;
        "></div>
      </div>
      <p style="text-align: center; font-size: 0.875rem; color: #6b7280; margin: 0;">
        ${selectedLanguage === 'en' 
          ? `Step ${current} of ${total} (${percentage}% complete)` 
          : `Paso ${current} de ${total} (${percentage}% completo)`
        }
      </p>
    `;
    container.style.display = 'block';
  }

  console.log('✅ WareWorks embed initialized');
})();
</script>